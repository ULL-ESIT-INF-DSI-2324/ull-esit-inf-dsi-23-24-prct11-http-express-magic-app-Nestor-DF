<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>doc-test</title><meta name="description" content="Documentation for doc-test"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">doc-test</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>doc-test</h2></div><div class="tsd-panel tsd-typography"><a id="md:práctica-11---aplicación-express-para-coleccionistas-de-cartas-magic" class="tsd-anchor"></a><h1><a href="#md:práctica-11---aplicación-express-para-coleccionistas-de-cartas-magic">Práctica 11 - Aplicación Express para coleccionistas de cartas Magic</a></h1><ul>
<li>Néstor Delgado Feliciano (<a href="mailto:alu0101488998@ull.edu.es">alu0101488998@ull.edu.es</a>)</li>
</ul>
<p><a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-Nestor-DF?branch=main"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2324/ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-Nestor-DF/badge.svg?branch=main" alt="Coverage Status"></a></p>
<p><a href="https://sonarcloud.io/summary/new_code?id=ULL-ESIT-INF-DSI-2324_ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-Nestor-DF"><img src="https://sonarcloud.io/api/project_badges/measure?project=ULL-ESIT-INF-DSI-2324_ull-esit-inf-dsi-23-24-prct11-http-express-magic-app-Nestor-DF&metric=alert_status" alt="Quality Gate Status"></a></p>
<a id="md:índice" class="tsd-anchor"></a><h2><a href="#md:índice"><strong>Índice</strong></a></h2><ul>
<li><a href="#md:práctica-11---aplicación-express-para-coleccionistas-de-cartas-magic">Práctica 11 - Aplicación Express para coleccionistas de cartas Magic</a><ul>
<li><a href="#md:índice"><strong>Índice</strong></a></li>
<li><a href="#md:introducción"><strong>Introducción</strong></a></li>
<li><a href="#md:desarrollo"><strong>Desarrollo</strong></a></li>
<li><a href="#md:conclusiones"><strong>Conclusiones</strong></a></li>
<li><a href="#md:recursos-empleados"><strong>Recursos Empleados</strong></a></li>
</ul>
</li>
</ul>
<a id="md:introducción" class="tsd-anchor"></a><h2><a href="#md:introducción"><strong>Introducción</strong></a></h2><p>En esta práctica se desarrollará una aplicación cliente-servidor usando <strong>Express</strong> para gestionar información sobre cartas del juego Magic: The Gathering. Desde un cliente como, por ejemplo, ThunderClient o Postman, se podrán llevar a cabo peticiones HTTP al servidor como añadir, modificar, eliminar, listar y leer la información asociada a estas cartas. Toda la información de cada carta se almacenará en formato JSON en el sistema de archivos del servidor.</p>
<a id="md:desarrollo" class="tsd-anchor"></a><h2><a href="#md:desarrollo"><strong>Desarrollo</strong></a></h2><p>A partir de la clase desarrollada en la práctica previa he reestructurado todos los métodos para que sean <strong>asíncronos y empleen el patrón callback</strong>, de forma que en caso de error, la variable <em>error</em> almacenará una cadena que describa la naturaleza del error, mientras que <em>result</em> permanecerá indefinido. Si la operación se realiza correctamente, <em>error</em> será indefinido y <em>result</em> contendrá un mensaje con el resultado deseado.</p>
<pre><code class="language-ts"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">class</span><span class="hl-1"> </span><span class="hl-3">CardManager</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-2">static</span><span class="hl-1"> </span><span class="hl-4">instance</span><span class="hl-1">: </span><span class="hl-3">CardManager</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-2">private</span><span class="hl-1"> </span><span class="hl-2">constructor</span><span class="hl-1">() {}</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-2">static</span><span class="hl-1"> </span><span class="hl-5">getInstance</span><span class="hl-1">(): </span><span class="hl-3">CardManager</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-4">CardManager</span><span class="hl-1">.</span><span class="hl-4">instance</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">CardManager</span><span class="hl-1">.</span><span class="hl-4">instance</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-5">CardManager</span><span class="hl-1">();</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-4">CardManager</span><span class="hl-1">.</span><span class="hl-4">instance</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-5">addCard</span><span class="hl-1">(</span><span class="hl-4">user</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-4">card</span><span class="hl-1">: </span><span class="hl-3">MagiCard</span><span class="hl-1">, </span><span class="hl-5">callback</span><span class="hl-1">: (</span><span class="hl-4">error</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1"> | </span><span class="hl-3">undefined</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1"> | </span><span class="hl-3">undefined</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-3">void</span><span class="hl-1">): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">userDirectory</span><span class="hl-1"> = </span><span class="hl-7">`./data/</span><span class="hl-2">${</span><span class="hl-4">user</span><span class="hl-2">}</span><span class="hl-7">`</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">cardFilePath</span><span class="hl-1"> = </span><span class="hl-7">`</span><span class="hl-2">${</span><span class="hl-4">userDirectory</span><span class="hl-2">}</span><span class="hl-7">/</span><span class="hl-2">${</span><span class="hl-4">card</span><span class="hl-8">.</span><span class="hl-5">getId</span><span class="hl-8">()</span><span class="hl-2">}</span><span class="hl-7">.json`</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">fs</span><span class="hl-1">.</span><span class="hl-5">mkdir</span><span class="hl-1">(</span><span class="hl-4">userDirectory</span><span class="hl-1">, { </span><span class="hl-4">recursive:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1"> }, (</span><span class="hl-4">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">err</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">callback</span><span class="hl-1">(</span><span class="hl-4">err</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">fs</span><span class="hl-1">.</span><span class="hl-5">stat</span><span class="hl-1">(</span><span class="hl-4">cardFilePath</span><span class="hl-1">, (</span><span class="hl-4">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">err</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-4">fs</span><span class="hl-1">.</span><span class="hl-5">writeFile</span><span class="hl-1">(</span><span class="hl-4">cardFilePath</span><span class="hl-1">, </span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-4">card</span><span class="hl-1">), (</span><span class="hl-4">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">err</span><span class="hl-1">) {</span><br/><span class="hl-1">                </span><span class="hl-5">callback</span><span class="hl-1">(</span><span class="hl-4">err</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">              } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-5">callback</span><span class="hl-1">(</span><span class="hl-2">undefined</span><span class="hl-1">, </span><span class="hl-7">`Card added in </span><span class="hl-2">${</span><span class="hl-4">user</span><span class="hl-2">}</span><span class="hl-7">&#39;s collection`</span><span class="hl-1">);</span><br/><span class="hl-1">              }</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">          } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">callback</span><span class="hl-1">(</span><span class="hl-7">`A card with the same ID already exists in </span><span class="hl-2">${</span><span class="hl-4">user</span><span class="hl-2">}</span><span class="hl-7">&#39;s collection`</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><br/><span class="hl-1">  </span><span class="hl-2">public</span><span class="hl-1"> </span><span class="hl-5">updateCard</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">user</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">: </span><span class="hl-3">MagiCard</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-5">callback</span><span class="hl-1">: (</span><span class="hl-4">error</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1"> | </span><span class="hl-3">undefined</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">: </span><span class="hl-3">string</span><span class="hl-1"> | </span><span class="hl-3">undefined</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> </span><span class="hl-3">void</span><span class="hl-1">,</span><br/><span class="hl-1">  ): </span><span class="hl-3">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">cardFilePath</span><span class="hl-1"> = </span><span class="hl-7">`./data/</span><span class="hl-2">${</span><span class="hl-4">user</span><span class="hl-2">}</span><span class="hl-7">/</span><span class="hl-2">${</span><span class="hl-4">card</span><span class="hl-8">.</span><span class="hl-5">getId</span><span class="hl-8">()</span><span class="hl-2">}</span><span class="hl-7">.json`</span><span class="hl-1">;</span><br/><br/><span class="hl-1">    </span><span class="hl-4">fs</span><span class="hl-1">.</span><span class="hl-5">stat</span><span class="hl-1">(</span><span class="hl-4">cardFilePath</span><span class="hl-1">, (</span><span class="hl-4">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">err</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-5">callback</span><span class="hl-1">(</span><span class="hl-7">`Card not found at </span><span class="hl-2">${</span><span class="hl-4">user</span><span class="hl-2">}</span><span class="hl-7">&#39;s collection`</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">fs</span><span class="hl-1">.</span><span class="hl-5">writeFile</span><span class="hl-1">(</span><span class="hl-4">cardFilePath</span><span class="hl-1">, </span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">(</span><span class="hl-4">card</span><span class="hl-1">), (</span><span class="hl-4">err</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">err</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-5">callback</span><span class="hl-1">(</span><span class="hl-4">err</span><span class="hl-1">.</span><span class="hl-4">message</span><span class="hl-1">, </span><span class="hl-2">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">          } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">callback</span><span class="hl-1">(</span><span class="hl-2">undefined</span><span class="hl-1">, </span><span class="hl-7">`Card updated in </span><span class="hl-2">${</span><span class="hl-4">user</span><span class="hl-2">}</span><span class="hl-7">&#39;s collection`</span><span class="hl-1">);</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-9">// Demás código</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>En lo que respecta el servidor HTTP creado con Express, he usado los verbos HTTP tal y cómo venía especificado en el guion:</p>
<ol>
<li><p><strong>GET /cards</strong>: Este endpoint se utiliza para obtener información sobre una carta específica o para listar todas las cartas de la colección de un usuario. Si se proporciona un ID de carta como parámetro de la consulta (query string), se devuelve la información de esa carta en particular. Si no se proporciona un ID, se devuelven todas las cartas de la colección del usuario.</p>
</li>
<li><p><strong>POST /cards</strong>: Se utiliza para añadir una nueva carta a la colección de un usuario. La información de la carta que se desea añadir se envía en formato JSON en el cuerpo de la petición, y el usuario se especifica como parámetro en la query string.</p>
</li>
<li><p><strong>DELETE /cards</strong>: Permite eliminar una carta específica de la colección de un usuario. Se espera que se proporcione tanto el ID de la carta como el nombre de usuario como parámetros en la query string.</p>
</li>
<li><p><strong>PATCH /cards</strong>: Este endpoint se utiliza para modificar la información de una carta existente en la colección de un usuario. Se espera que se proporcione tanto el ID de la carta como el nombre de usuario como parámetros en la query string. La nueva información de la carta se envía en formato JSON en el cuerpo de la petición. Además, se verifica que el ID de la carta en el cuerpo de la petición coincida con el proporcionado en la query string.</p>
</li>
</ol>
<pre><code class="language-ts"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> = </span><span class="hl-5">express</span><span class="hl-1">();</span><br/><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-5">use</span><span class="hl-1">(</span><span class="hl-4">express</span><span class="hl-1">.</span><span class="hl-5">json</span><span class="hl-1">());</span><br/><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-5">get</span><span class="hl-1">(</span><span class="hl-7">&#39;/cards&#39;</span><span class="hl-1">, (</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">user</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">error:</span><span class="hl-1"> </span><span class="hl-7">&#39;An user has to be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">cardManager</span><span class="hl-1">.</span><span class="hl-5">showCard</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">user</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-5">parseInt</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">string</span><span class="hl-1">), (</span><span class="hl-4">error</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">(</span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({ </span><span class="hl-4">status:</span><span class="hl-1"> </span><span class="hl-7">&#39;Error&#39;</span><span class="hl-1">, </span><span class="hl-4">answer:</span><span class="hl-1"> </span><span class="hl-4">error</span><span class="hl-1"> }));</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">(</span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({ </span><span class="hl-4">status:</span><span class="hl-1"> </span><span class="hl-7">&#39;CardsReceived&#39;</span><span class="hl-1">, </span><span class="hl-4">answer:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1"> }));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">cardManager</span><span class="hl-1">.</span><span class="hl-5">listCollection</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">user</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">string</span><span class="hl-1">, (</span><span class="hl-4">error</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">(</span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({ </span><span class="hl-4">status:</span><span class="hl-1"> </span><span class="hl-7">&#39;Error&#39;</span><span class="hl-1">, </span><span class="hl-4">answer:</span><span class="hl-1"> </span><span class="hl-4">error</span><span class="hl-1"> }));</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">(</span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({ </span><span class="hl-4">status:</span><span class="hl-1"> </span><span class="hl-7">&#39;CardsReceived&#39;</span><span class="hl-1">, </span><span class="hl-4">answer:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1"> }));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-5">post</span><span class="hl-1">(</span><span class="hl-7">&#39;/cards&#39;</span><span class="hl-1">, (</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">user</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">error:</span><span class="hl-1"> </span><span class="hl-7">&#39;An user has to be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">cardManager</span><span class="hl-1">.</span><span class="hl-5">addCard</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">user</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-5">JSONtoCard</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">body</span><span class="hl-1">), (</span><span class="hl-4">error</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">(</span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({ </span><span class="hl-4">status:</span><span class="hl-1"> </span><span class="hl-7">&#39;Error&#39;</span><span class="hl-1">, </span><span class="hl-4">answer:</span><span class="hl-1"> </span><span class="hl-4">error</span><span class="hl-1"> }));</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">(</span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({ </span><span class="hl-4">status:</span><span class="hl-1"> </span><span class="hl-7">&#39;Success&#39;</span><span class="hl-1">, </span><span class="hl-4">answer:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1"> }));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">app</span><span class="hl-1">.</span><span class="hl-5">delete</span><span class="hl-1">(</span><span class="hl-7">&#39;/cards&#39;</span><span class="hl-1">, (</span><span class="hl-4">req</span><span class="hl-1">, </span><span class="hl-4">res</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">user</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">error:</span><span class="hl-1"> </span><span class="hl-7">&#39;An user has to be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-4">error:</span><span class="hl-1"> </span><span class="hl-7">&#39;An id has to be provided&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">cardManager</span><span class="hl-1">.</span><span class="hl-5">removeCard</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">user</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">string</span><span class="hl-1">, </span><span class="hl-5">parseInt</span><span class="hl-1">(</span><span class="hl-4">req</span><span class="hl-1">.</span><span class="hl-4">query</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1"> </span><span class="hl-0">as</span><span class="hl-1"> </span><span class="hl-3">string</span><span class="hl-1">), (</span><span class="hl-4">error</span><span class="hl-1">, </span><span class="hl-4">result</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-4">error</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">(</span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({ </span><span class="hl-4">status:</span><span class="hl-1"> </span><span class="hl-7">&#39;Error&#39;</span><span class="hl-1">, </span><span class="hl-4">answer:</span><span class="hl-1"> </span><span class="hl-4">error</span><span class="hl-1"> }));</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">res</span><span class="hl-1">.</span><span class="hl-5">send</span><span class="hl-1">(</span><span class="hl-6">JSON</span><span class="hl-1">.</span><span class="hl-5">stringify</span><span class="hl-1">({ </span><span class="hl-4">status:</span><span class="hl-1"> </span><span class="hl-7">&#39;Success&#39;</span><span class="hl-1">, </span><span class="hl-4">answer:</span><span class="hl-1"> </span><span class="hl-4">result</span><span class="hl-1"> }));</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><span class="hl-9">// Demás código</span>
</code><button>Copy</button></pre>
<p>Se puede observar como todas las peticiones se hacen a través de la ruta <strong>/cards</strong> y cómo se sigue una estructura básica. Es decir,  se comprueban los parámetros de la <strong>query string</strong> y en base a estos se realiza una acción u otra. Por ejemplo, se comprueba que el usuario esté en la <strong>query string</strong> en todas las peticiones y si no está se manda un mensaje de respuesta de error. A continuación,  se comprueba el campo <strong>id</strong> y si todo es correcto se llama al método correpondiente de la clase <strong>CardManager</strong> empleando el <strong>patrón callback</strong>.</p>
<p>Se destaca como todas las <strong>respuestas</strong> del servidor están en <strong>formato JSON</strong> y siguen la misma estructura {status, asnwer}</p>
<p>Por otro lado, por temas de <strong>compatibilidad</strong> con la clase <strong>CardManager</strong> tuve que hacer una función simple para convertir las <strong>cartas</strong> que vienen en formato <strong>JSON</strong> en el <em><strong>body</strong></em> de la petición a objetos <strong>MagiCard</strong>.</p>
<pre><code class="language-ts"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">function</span><span class="hl-1"> </span><span class="hl-5">JSONtoCard</span><span class="hl-1">(</span><span class="hl-4">card</span><span class="hl-1">: </span><span class="hl-3">any</span><span class="hl-1">): </span><span class="hl-3">MagiCard</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-6">magiCard</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-5">MagiCard</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">id</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">name</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">manaCost</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">color</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">cardType</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">rarity</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">rulesText</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">marketValue</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">powerToughness</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">card</span><span class="hl-1">.</span><span class="hl-4">loyalty</span><span class="hl-1">,</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-4">magiCard</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:conclusiones" class="tsd-anchor"></a><h2><a href="#md:conclusiones"><strong>Conclusiones</strong></a></h2><p>En conclusión, esta práctica me ha ayudado a entender mejor como implementar un servidor HTTP con Express, el significado de los diferentes verbos HTTP y cómo emplear el patrón callback de mejor forma. Así como el funcionamiento general cliente-servidor.</p>
<a id="md:recursos-empleados" class="tsd-anchor"></a><h2><a href="#md:recursos-empleados"><strong>Recursos Empleados</strong></a></h2><ol>
<li><p>OpenAI Chat: <a href="https://chat.openai.com/">https://chat.openai.com/</a> - Plataforma de IA conversacional proporcionada por OpenAI para tareas y aplicaciones de procesamiento de lenguaje natural.</p>
</li>
<li><p>W3Schools JavaScript Reference: <a href="https://www.w3schools.com/jsrEF/default.asp">https://www.w3schools.com/jsrEF/default.asp</a> - Recurso en línea completo para aprender y consultar conceptos, sintaxis y mejores prácticas del lenguaje de programación JavaScript.</p>
</li>
<li><p>MDN Web Docs - JavaScript Reference: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference</a> - Documentación oficial de la Red de Desarrolladores de Mozilla que proporciona explicaciones detalladas, ejemplos y referencias para las características del lenguaje JavaScript y las API.</p>
</li>
<li><p>API asíncrona proporcionada por Node.js para trabajar con el sistema de archivos: <a href="https://nodejs.org/docs/latest/api/fs.html">https://nodejs.org/docs/latest/api/fs.html</a></p>
</li>
</ol>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:práctica-11---aplicación-express-para-coleccionistas-de-cartas-magic"><span>Práctica 11 -<wbr/> <wbr/>Aplicación <wbr/>Express para coleccionistas de cartas <wbr/>Magic</span></a><ul><li><a href="#md:índice"><span>Índice</span></a></li><li><a href="#md:introducción"><span>Introducción</span></a></li><li><a href="#md:desarrollo"><span>Desarrollo</span></a></li><li><a href="#md:conclusiones"><span>Conclusiones</span></a></li><li><a href="#md:recursos-empleados"><span>Recursos <wbr/>Empleados</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>doc-test</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><div class="tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div></body></html>